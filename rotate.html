<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
    <script>
        // 初始化场景、相机和渲染器
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x000000);
        document.body.appendChild(renderer.domElement);
        
        // 添加轨道控制器
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        
        // 设置相机位置
        camera.position.set(0, 0, 5);
        controls.update();
        
        // 添加环境光和定向光
        const ambientLight = new THREE.AmbientLight(0x404040);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
        directionalLight.position.set(1, 1, 1);
        scene.add(directionalLight);
        
        // 创建地球
        const earthGeometry = new THREE.SphereGeometry(1, 32, 32);
        const earthTexture = new THREE.TextureLoader().load('https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg');
        const earthMaterial = new THREE.MeshPhongMaterial({ 
            map: earthTexture,
            specular: new THREE.Color(0x333333),
            shininess: 5
        });
        const earth = new THREE.Mesh(earthGeometry, earthMaterial);
        scene.add(earth);
        
        // 创建嫦娥六号模型
        const changE6Group = new THREE.Group();
        
        // 1. 轨道器 (顶部小型白色长方体) - 比例缩小2倍
        const orbiterGeometry = new THREE.BoxGeometry(0.075, 0.03, 0.075); // 缩小2倍
        const orbiterMaterial = new THREE.MeshPhongMaterial({ 
            color: 0xffffff,
            emissive: 0x222222,
            specular: 0x999999,
            shininess: 30
        });
        const orbiter = new THREE.Mesh(orbiterGeometry, orbiterMaterial);
        orbiter.position.y = 0.095; // 调整位置使与返回器无间隙
        changE6Group.add(orbiter);
        
        // 2. 返回器 (大型白色长方体) - 比例缩小2倍
        const returnerGeometry = new THREE.BoxGeometry(0.1, 0.05, 0.1); // 缩小2倍
        const returnerMaterial = new THREE.MeshPhongMaterial({ 
            color: 0xffffff,
            emissive: 0x222222,
            specular: 0x999999,
            shininess: 30
        });
        const returner = new THREE.Mesh(returnerGeometry, returnerMaterial);
        returner.position.y = 0.05; // 调整位置使与轨道器无间隙
        changE6Group.add(returner);
        
        // 返回器的太阳能板 (两侧蓝色面板) - 比例缩小2倍
        const solarPanelGeometry = new THREE.BoxGeometry(0.12, 0.06, 0.01); // 缩小2倍
        const solarPanelMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x0e197f,
            emissive: 0x003366,
            specular: 0x6666ff,
            shininess: 50
        });
        
        const leftSolarPanel = new THREE.Mesh(solarPanelGeometry, solarPanelMaterial);
        leftSolarPanel.position.set(-0.12, 0.0625, 0); // 调整位置
        leftSolarPanel.rotation.x = Math.PI/2; // 固定太阳能板方向
        changE6Group.add(leftSolarPanel);
        
        const rightSolarPanel = new THREE.Mesh(solarPanelGeometry, solarPanelMaterial);
        rightSolarPanel.position.set(0.12, 0.0625, 0); // 调整位置
        rightSolarPanel.rotation.x = Math.PI/2; // 固定太阳能板方向
        changE6Group.add(rightSolarPanel);
        
        // 3. 着陆器 (金色圆柱) - 比例缩小2倍
        const landerGeometry = new THREE.CylinderGeometry(0.05, 0.058, 0.05, 16); // 缩小2倍
        const landerMaterial = new THREE.MeshPhongMaterial({ 
            color: 0xb18f3b,
            emissive: 0x996600,
            specular: 0xffdd55,
            shininess: 40
        });
        const lander = new THREE.Mesh(landerGeometry, landerMaterial);
        lander.position.y = -0.005; // 调整位置
        changE6Group.add(lander);
        
        // 4. 上升器 (白色圆台，上小下大)
        const ascenderGeometry = new THREE.CylinderGeometry(0.058, 0.058, 0.05, 16); // 上半径0.05，下半径0.075
        const ascenderMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x0e197f,
            emissive: 0x222222,
            specular: 0x999999,
            shininess: 30
        });
        const ascender = new THREE.Mesh(ascenderGeometry, ascenderMaterial);
        ascender.position.y = -0.06; // 调整位置
        changE6Group.add(ascender);
        
        // 5. 二级火箭 (白色圆柱，直径与上升器下底面相同)
        const rocketGeometry = new THREE.CylinderGeometry(0.07, 0.07, 0.12, 16); // 直径0.15(半径0.075)
        const rocketMaterial = new THREE.MeshPhongMaterial({ 
            color: 0xffffff,
            emissive: 0x222222,
            specular: 0x999999,
            shininess: 30
        });
        const rocket = new THREE.Mesh(rocketGeometry, rocketMaterial);
        rocket.position.y = -0.15; // 调整位置
        changE6Group.add(rocket);
        
        // 创建轨道组
        const orbitGroup = new THREE.Group();
        scene.add(orbitGroup);
        orbitGroup.add(changE6Group);
        
        // 创建轨道 (椭圆)
        const orbitRadiusX = 2.5;
        const orbitRadiusY = 1.8;
        const orbitPoints = [];
        const orbitSegments = 100;
        
        for (let i = 0; i <= orbitSegments; i++) {
            const theta = (i / orbitSegments) * Math.PI * 2;
            const x = orbitRadiusX * Math.cos(theta);
            const y = orbitRadiusY * Math.sin(theta);
            orbitPoints.push(new THREE.Vector3(x, 0, y));
        }
        
        // 创建虚线轨道
        const orbitLineGeometry = new THREE.BufferGeometry().setFromPoints(orbitPoints);
        const orbitLineMaterial = new THREE.LineDashedMaterial({
            color: 0xffffff,
            dashSize: 0.1,
            gapSize: 0.05,
            linewidth: 1
        });
        const orbitLine = new THREE.Line(orbitLineGeometry, orbitLineMaterial);
        orbitLine.computeLineDistances(); // 必须调用这个才能使虚线生效
        scene.add(orbitLine);
        
        // 动画循环
        let angle = 0;
        const orbitSpeed = 0.005;
        
        function animate() {
            requestAnimationFrame(animate);
            
            // 更新嫦娥六号位置
            angle += orbitSpeed;
            changE6Group.position.x = orbitRadiusX * Math.cos(angle);
            changE6Group.position.z = orbitRadiusY * Math.sin(angle);
            
            // 使嫦娥六号始终朝向轨道切线方向
            const tangentAngle = Math.atan2(
                orbitRadiusY * Math.cos(angle),
                -orbitRadiusX * Math.sin(angle)
            );
            changE6Group.rotation.y = tangentAngle;
            
            // 更新控制器
            controls.update();
            
            // 渲染场景
            renderer.render(scene, camera);
        }
        
        // 处理窗口大小变化
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        animate();
    </script>
</body>
</html>